@page
@using CurrencyConverter.Helpers
@using CurrencyConverter.Models
@{
    ViewBag.Title = "Currency Converter";

    // Fetch and parse the XML data
    List<Currency> currencies = XmlDocumentHelper.FetchDataFromXml();
}

<h1>Currency Converter</h1>
<form>
    <label for="amount">Amount:</label>
    <input type="number" id="amount" required />
    <br />
    <label for="fromCurrency">From:</label>
    <select id="fromCurrency">
        @foreach (var currency in currencies)
        {
            <option value="@currency.Rate" text="@currency.Code">@currency.Code</option>
        }
    </select>
    <br />
    <label for="toCurrency">To:</label>
    <select id="toCurrency">
        @foreach (var currency in currencies)
        {
            <option value="@currency.Rate" text="@currency.Code">@currency.Code</option>
        }
    </select>
    <br />
    <button type="submit">Convert</button>
</form>
<p id="result"></p>

@section Scripts {
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script>$(document).ready(function () {
            $("form").submit(function (event) {
                event.preventDefault();

                var amount = $("#amount").val();
                var fromCurrency = $("#fromCurrency").val();
                var toCurrency = $("#toCurrency").val();

                var convertedAmount = amount * toCurrency / fromCurrency;

                $("#result").text(convertedAmount.toFixed(2));
            });
        });</script>
}
